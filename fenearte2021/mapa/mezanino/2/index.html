<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Map Fenearte</title>

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link rel="stylesheet" href="styles/st.css">

  </head>

  <style>
    body{
      background-color: rgb(254, 230, 20);
    }
    .btn-opt{
        background-color: rgb(255, 201, 13);
        font-family: Variex;
        margin-top: 15px;
        color:black;
        font-size: 1.2em;
    }
  </style>

  <body>

    <div class="container">

      <div class="text-center">
        <br>
        <button type="button" class="btn btn-opt" data-toggle="modal" data-target="#exampleModal" data-whatever="@mdo">Nova Rota</button>

        <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <form action="" class="needs-validation" novalidate>
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-body">
                  <div class="row">
                    <div class="form-group col-md-12">
                      <label for="beginSelect">Sua localização</label>
                      <select class="custom-select d-block w-120" name="beginSelect" id="beginSelect" required style="height: 46px;">
                        <option value="">Selecione</option>
                        <option value="escadaa1">Escada A</option>
                        <option value="escadab2">Escada B</option>
                        <option value="escadac3">Escada C</option>
                        <option value="boteco1">Boteco Apercerva</option>
                        <option value="caixaseletronicos1">Caixas Eletrônicos</option>
                        <option value="expmuseu1">Exposição Museu Homem do Nordeste</option>
                        <option value="imprensa1">Imprensa</option>
                        <option value="info1">Informações</option>
                        <option value="midiadigital1">Midia Digital</option>
                        <option value="oficinaa1">Oficina A</option>
                        <option value="oficinab2">Oficina B</option>
                        <option value="oficinac3">Oficina C</option>
                        <option value="oficinad4">Oficina D</option>
                        <option value="oficinae5">Oficina E</option>
                        <option value="passarela1">Passarela</option>
                        <option value="alimentacao1">Praça de Alimentação</option>
                        <option value="procon1">Procon</option>
                        <option value="radioa1">Radio A</option>
                        <option value="radiob2">Radio B</option>
                        <option value="radioc3">Radio C</option>
                        <option value="restaurante1">Restaurante</option>
                        <option value="rodnegocios1">Rodada de Negocios Internacionais</option>
                        <option value="secretariafazenda1">Secretaria da Fazenda </option>
                        <option value="teatroinfantil1">Teatro Infantil</option>
                        <option value="wc">WC</option>
                      </select>
                      <div class="invalid-feedback">
                        Selecione um estande próximo a você!
                      </div>
                    </div>
                    <div class="form-group col-md-12">
                      <label for="endSelect">Destino</label>
                      <select class="custom-select d-block w-120" name="endSelect" id="endSelect" required style="height: 46px;">
                        <option value="">Selecione</option>
                        <option value="escadaa1">Escada A</option>
                        <option value="escadab2">Escada B</option>
                        <option value="escadac3">Escada C</option>
                        <option value="boteco1">Boteco Apercerva</option>
                        <option value="caixaseletronicos1">Caixas Eletrônicos</option>
                        <option value="expmuseu1">Exposição Museu Homem do Nordeste</option>
                        <option value="imprensa1">Imprensa</option>
                        <option value="info1">Informações</option>
                        <option value="midiadigital1">Midia Digital</option>
                        <option value="oficinaa1">Oficina A</option>
                        <option value="oficinab2">Oficina B</option>
                        <option value="oficinac3">Oficina C</option>
                        <option value="oficinad4">Oficina D</option>
                        <option value="oficinae5">Oficina E</option>
                        <option value="passarela1">Passarela</option>
                        <option value="alimentacao1">Praça de Alimentação</option>
                        <option value="procon1">Procon</option>
                        <option value="radioa1">Radio A</option>
                        <option value="radiob2">Radio B</option>
                        <option value="radioc3">Radio C</option>
                        <option value="restaurante1">Restaurante</option>
                        <option value="rodnegocios1">Rodada de Negocios Internacionais</option>
                        <option value="secretariafazenda1">Secretaria da Fazenda </option>
                        <option value="teatroinfantil1">Teatro Infantil</option>
                        <option value="wc">WC</option>
                      </select>
                      <div class="invalid-feedback">
                        Selecione o estande para onde deseja ir!
                      </div>
                    </div>
                  </div>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Fechar</button>
                <button type="submit" class="btn btn-primary">Traçar Rota</button>
              </div>
            </div>
          </div>
        </form>
        </div>

          <div class="row">
    			 <div id="myMaps" class="col-md-12"></div>
          </div>

      </div>
    </div>

    <script src="src/jquery.min.js"></script>
    <script src="src/jquery.wayfinding.js"></script>

    <script>
      function queryObj() {
          var result = {}, keyValuePairs = location.search.slice(1).split("&");
          keyValuePairs.forEach(function(keyValuePair) {
              keyValuePair = keyValuePair.split('=');
              result[decodeURIComponent(keyValuePair[0])] = decodeURIComponent(keyValuePair[1]) || '';
          });
          return result;
      }
      var myParam = queryObj();


      $(document).ready(function () {
        'use strict';
        $('#myMaps').wayfinding({
          'maps': [
            {'path': 'MEZANINO_gustavo.svg', 'id': 'floor1'}
          ],
          'path': {
            width: 10,
            color: 'green',
            radius: 8,
            speed: 4
          },
          'startpoint': function () {
            return myParam.beginSelect;
          },
          'endpoint': function() {
            return myParam.endselect;
          },
          'defaultMap': 'floor1',
          'showLocation': true
        }, function(){
          console.log('callback reached');
        });

        $('#myMaps').wayfinding('startpoint', myParam.beginSelect.toString());
        $('#myMaps').wayfinding('routeTo', myParam.endSelect.toString());

        //make the floor buttons clickable
        $('#controls button').click(function () {
          $('#myMaps').wayfinding('currentMap', $(this).prop('id'));
        });

        $('#controls #beginSelect').change(function () {
          $('#myMaps').wayfinding('startpoint', $(this).val());
          if ($('#endSelect').val() !== '') {
            $('#myMaps').wayfinding('routeTo', $('#endSelect').val());
          }
        });

        $('#controls #endSelect').change(function () {
          $('#myMaps').wayfinding('routeTo', $(this).val());
        });

        $('#controls #accessible').change(function () {
          if ($('#accessible:checked').val() !== undefined) {
            $('#myMaps').wayfinding('accessibleRoute', true);
          } else {
            $('#myMaps').wayfinding('accessibleRoute', false);
          }
          if ($('#endSelect').val() !== '') {
            $('#myMaps').wayfinding('routeTo', $('#endSelect').val());
          }
        });

        $('#myMaps').on('wayfinding:roomClicked', function(e, r) {
          $('#endSelect option[value="' + r.roomId + '"]').attr('selected', true);
        });

      });
    </script>
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>

    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

    <script>
      document.documentElement.requestFullscreen();
      // Example starter JavaScript for disabling form submissions if there are invalid fields
      (function() {
        'use strict';

        window.addEventListener('load', function() {
          // Fetch all the forms we want to apply custom Bootstrap validation styles to
          var forms = document.getElementsByClassName('needs-validation');

          // Loop over them and prevent submission
          var validation = Array.prototype.filter.call(forms, function(form) {
            form.addEventListener('submit', function(event) {
              if (form.checkValidity() === false) {
                event.preventDefault();
                event.stopPropagation();
              }
              form.classList.add('was-validated');
            }, false);
          });
        }, false);
      })();
      $('#beginSelect option[value="' + myParam.endSelect + '"]').attr('selected', true);
      $('#beginSelect').trigger("change");
    </script>
  </body>
</html>